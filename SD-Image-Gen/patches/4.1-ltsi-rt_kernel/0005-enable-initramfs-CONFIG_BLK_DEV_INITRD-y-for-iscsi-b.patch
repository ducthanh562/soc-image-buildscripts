From 66df4e4c7c55a7fb437507374dc779a28a921535 Mon Sep 17 00:00:00 2001
From: the-snowwhite <producer@holotronic.dk>
Date: Thu, 23 Jun 2016 03:53:46 +0200
Subject: [PATCH 5/5] enable initramfs CONFIG_BLK_DEV_INITRD=y for iscsi boot

Signed-off-by: the-snowwhite <producer@holotronic.dk>
---
 arch/arm/configs/socfpga_defconfig | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

diff --git a/arch/arm/configs/socfpga_defconfig b/arch/arm/configs/socfpga_defconfig
index a791fc2..dde91e4 100644
--- a/arch/arm/configs/socfpga_defconfig
+++ b/arch/arm/configs/socfpga_defconfig
@@ -12,7 +12,16 @@ CONFIG_PROFILING=y
 CONFIG_MODULES=y
 CONFIG_MODULE_UNLOAD=y
 CONFIG_LBDAF=y
-# CONFIG_BLK_DEV_BSG is not set
+CONFIG_BLK_DEV_INITRD=y
+CONFIG_INITRAMFS_SOURCE="~/socfpga/boot"
+CONFIG_INITRAMFS_ROOT_UID=0
+CONFIG_INITRAMFS_ROOT_GID=0
+CONFIG_RD_GZIP=y
+CONFIG_RD_BZIP2=y
+CONFIG_RD_LZMA=y
+CONFIG_RD_XZ=y
+CONFIG_RD_LZO=y
+CONFIG_RD_LZ4=y
 # CONFIG_IOSCHED_DEADLINE is not set
 # CONFIG_IOSCHED_CFQ is not set
 CONFIG_ARCH_SOCFPGA=y
@@ -76,7 +85,7 @@ CONFIG_SCSI_CONSTANTS=y
 CONFIG_SCSI_ISCSI_ATTRS=y
 CONFIG_SCSI_LOWLEVEL=y
 CONFIG_ISCSI_TCP=y
-CONFIG_ISCSI_BOOT_SYSFS=y
+# CONFIG_ISCSI_BOOT_SYSFS=y
 CONFIG_VMWARE_PVSCSI=m
 CONFIG_NETDEVICES=y
 CONFIG_E1000E=m
-- 
2.8.1

