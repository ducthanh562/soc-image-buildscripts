From 1ebdd8ddbc0c42d83d2fe93edbe1ddbe5fa6b63a Mon Sep 17 00:00:00 2001
From: the-snowwhite <producer@holotronic.dk>
Date: Thu, 7 Apr 2016 20:28:13 +0200
Subject: [PATCH 1/3] add ext4 root fs support and autofs4 module

Signed-off-by: the-snowwhite <producer@holotronic.dk>
---
 arch/arm/configs/socfpga_defconfig | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/arch/arm/configs/socfpga_defconfig b/arch/arm/configs/socfpga_defconfig
index f7e1631..956993b 100644
--- a/arch/arm/configs/socfpga_defconfig
+++ b/arch/arm/configs/socfpga_defconfig
@@ -12,7 +12,7 @@ CONFIG_OPROFILE=y
 CONFIG_MODULES=y
 CONFIG_MODULE_UNLOAD=y
 CONFIG_HOTPLUG=y
-# CONFIG_LBDAF is not set
+CONFIG_LBDAF=yt
 # CONFIG_BLK_DEV_BSG is not set
 # CONFIG_IOSCHED_DEADLINE is not set
 # CONFIG_IOSCHED_CFQ is not set
@@ -104,6 +104,7 @@ CONFIG_SPI_DW_MMIO=y
 CONFIG_SPI_SPIDEV=y
 CONFIG_GPIOLIB=y
 CONFIG_GPIO_SYSFS=y
+CONFIG_AUTOFS4_FS=m
 CONFIG_GPIO_DWAPB=y
 CONFIG_GPIO_ALTERA=m
 CONFIG_GPIO_A10SYCON=y
@@ -121,6 +122,9 @@ CONFIG_EXT3_FS=y
 CONFIG_EXT3_DEFAULTS_TO_ORDERED=y
 CONFIG_EXT3_FS_XATTR=y
 CONFIG_EXT4_FS=y
+CONFIG_EXT4_FS_XATTR=y
+CONFIG_EXT4_FS_POSIX_ACL=y
+CONFIG_EXT4_FS_SECURITY=y
 # CONFIG_EXT3_FS_POSIX_ACL is not set
 # CONFIG_EXT3_FS_SECURITY is not set
 # CONFIG_DNOTIFY is not set
-- 
2.8.0.rc3


From 61386da5d7a4b651b8697669417bb1eb6ee810bf Mon Sep 17 00:00:00 2001
From: the-snowwhite <producer@holotronic.dk>
Date: Thu, 7 Apr 2016 20:29:34 +0200
Subject: [PATCH 2/3] add uio driver support

Signed-off-by: the-snowwhite <producer@holotronic.dk>
---
 arch/arm/configs/socfpga_defconfig | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/arch/arm/configs/socfpga_defconfig b/arch/arm/configs/socfpga_defconfig
index 956993b..c779ae0 100644
--- a/arch/arm/configs/socfpga_defconfig
+++ b/arch/arm/configs/socfpga_defconfig
@@ -196,3 +196,6 @@ CONFIG_PREEMPT_RT=y
 CONFIG_PREEMPT_RT_FULL=y
 CONFIG_MARVELL_PHY=y
 CONFIG_FHANDLE=y
+CONFIG_UIO=y
+CONFIG_UIO_PDRV=y
+CONFIG_UIO_PDRV_GENIRQ=y
-- 
2.8.0.rc3


From c6c0a016d7a2090db09773a5bdf501800f9662e2 Mon Sep 17 00:00:00 2001
From: the-snowwhite <producer@holotronic.dk>
Date: Sun, 10 Apr 2016 01:08:05 +0200
Subject: [PATCH 3/3] add hm2reg_io and adc_ltc2308_fifo dtb entries

---
 arch/arm/boot/dts/socfpga.dtsi | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)

diff --git a/arch/arm/boot/dts/socfpga.dtsi b/arch/arm/boot/dts/socfpga.dtsi
index 4fc29ef..b5ebc9d 100644
--- a/arch/arm/boot/dts/socfpga.dtsi
+++ b/arch/arm/boot/dts/socfpga.dtsi
@@ -828,7 +828,7 @@
 				enable-dma = <1>;
 			};
 		};
-		
+
 		sysmgr@ffd08000 {
 			compatible = "altr,sys-mgr", "syscon";
 			reg = <0xffd08000 0x4000>;
@@ -947,5 +947,24 @@
 			clocks = <&per_base_clk>;
 			status = "disabled";
 		};
+
+		hm2reg_io_0: hm2-socfpga@0xff240000 {
+			compatible = "machkt,hm2reg-io-1.0";
+			reg = <0xff240000 0x00010000>;
+			clocks = <&osc1>;
+			address_width = <14>;
+			data_width = <32>;
+         status = "enabled";
+		};
+
+		adc_ltc2308_fifo_0: ltc2308-adc@0xff250000 {
+			compatible = "machkt,adc-ltc2308-1.1";
+			reg = <0xff250000 0x00000008>;
+			clocks = <&osc1 &h2f_usr1_clk>;
+			clock-names = "clock_sink", "clock_sink_adc";
+			address_width = <3>;
+			data_width = <16>;
+			status = "disabled";
+		};
 	};
 };
-- 
2.8.0.rc3

